// init
gStockId = 0;
FL=[];
SP=[];
PC=[];
gIdx = 0;
gArr=[];
gName = "";
gSecondName = "";
enable = 1;
var seriesOptions = [];
gLabel = ['', '內部累計持股', '內部持股變化'];
first = [0,0];

g_id_list = ['1101','1102','1103','1104','1108','1109','1110','1201','1203','1210','1213','1215','1216','1217','1218','1219','1220','1225','1227','1229','1231','1232','1233','1234','1235','1236','1240','1256','1258','1259','1264','1268','1301','1303','1304','1305','1307','1308','1309','1310','1312','1313','1314','1315','1316','1319','1321','1323','1324','1325','1326','1336','1337','1338','1339','1340','1341','1342','1402','1409','1410','1413','1414','1416','1417','1418','1419','1423','1432','1434','1435','1436','1437','1438','1439','1440','1441','1442','1443','1444','1445','1446','1447','1449','1451','1452','1453','1454','1455','1456','1457','1459','1460','1463','1464','1465','1466','1467','1468','1470','1471','1472','1473','1474','1475','1476','1477','1503','1504','1506','1507','1512','1513','1514','1515','1516','1517','1519','1521','1522','1524','1525','1526','1527','1528','1529','1530','1531','1532','1533','1535','1536','1537','1538','1539','1540','1541','1558','1560','1565','1568','1569','1570','1580','1582','1583','1584','1586','1587','1589','1590','1591','1592','1593','1595','1597','1598','1599','1603','1604','1605','1608','1609','1611','1612','1614','1615','1616','1617','1618','1626','1701','1702','1707','1708','1709','1710','1711','1712','1713','1714','1717','1718','1720','1721','1722','1723','1724','1725','1726','1727','1730','1731','1732','1733','1734','1735','1736','1737','1742','1752','1760','1762','1773','1776','1777','1781','1783','1784','1785','1786','1788','1789','1795','1796','1799','1802','1805','1806','1808','1809','1810','1813','1815','1817','1903','1904','1905','1906','1907','1909','2002','2006','2007','2008','2009','2010','2012','2013','2014','2015','2017','2020','2022','2023','2024','2025','2027','2028','2029','2030','2031','2032','2033','2034','2035','2038','2049','2059','2061','2062','2063','2064','2065','2066','2067','2069','2070','2101','2102','2103','2104','2105','2106','2107','2108','2109','2114','2115','2201','2204','2206','2207','2208','2221','2227','2228','2230','2231','2233','2235','2236','2239','2241','2243','2247','2301','2302','2303','2305','2308','2312','2313','2314','2316','2317','2321','2323','2324','2327','2328','2329','2330','2331','2332','2337','2338','2340','2342','2344','2345','2347','2348','2349','2351','2352','2353','2354','2355','2356','2357','2358','2359','2360','2362','2363','2364','2365','2367','2368','2369','2371','2373','2374','2375','2376','2377','2379','2380','2382','2383','2385','2387','2388','2390','2392','2393','2395','2397','2399','2401','2402','2404','2405','2406','2408','2409','2412','2413','2414','2415','2417','2419','2420','2421','2423','2424','2425','2426','2427','2428','2429','2430','2431','2433','2434','2436','2438','2439','2440','2441','2442','2443','2444','2448','2449','2450','2451','2453','2454','2455','2456','2457','2458','2459','2460','2461','2462','2464','2465','2466','2467','2468','2471','2472','2474','2476','2477','2478','2480','2481','2482','2483','2484','2485','2486','2488','2489','2491','2492','2493','2495','2496','2497','2498','2501','2504','2505','2506','2509','2511','2514','2515','2516','2520','2524','2527','2528','2530','2534','2535','2536','2537','2538','2539','2540','2542','2543','2545','2546','2547','2548','2596','2597','2601','2603','2605','2606','2607','2608','2609','2610','2611','2612','2613','2614','2615','2616','2617','2618','2630','2633','2634','2636','2637','2640','2641','2642','2643','2701','2702','2704','2705','2706','2707','2712','2718','2719','2722','2723','2724','2726','2727','2729','2731','2732','2734','2736','2739','2740','2743','2745','2748','2752','2754','2801','2809','2812','2816','2820','2823','2832','2834','2836','2838','2841','2845','2849','2850','2851','2852','2855','2867','2880','2881','2882','2883','2884','2885','2886','2887','2888','2889','2890','2891','2892','2897','2901','2903','2904','2905','2906','2908','2910','2911','2912','2913','2915','2916','2923','2924','2926','2928','2929','2936','2937','2939','3002','3003','3004','3005','3006','3008','3010','3011','3013','3014','3015','3016','3017','3018','3019','3021','3022','3023','3024','3025','3026','3027','3028','3029','3030','3031','3032','3033','3034','3035','3036','3037','3038','3040','3041','3042','3043','3044','3045','3046','3047','3048','3049','3050','3051','3052','3054','3055','3056','3057','3058','3059','3060','3062','3064','3066','3067','3071','3073','3078','3081','3083','3085','3086','3088','3089','3090','3092','3093','3094','3095','3105','3114','3115','3118','3122','3128','3130','3131','3141','3144','3147','3149','3152','3162','3163','3164','3167','3169','3171','3176','3178','3188','3189','3191','3202','3205','3206','3207','3209','3211','3213','3217','3218','3219','3221','3224','3226','3227','3228','3229','3230','3231','3232','3234','3236','3252','3257','3259','3260','3264','3265','3266','3268','3272','3276','3284','3285','3287','3288','3289','3290','3293','3294','3296','3297','3303','3305','3306','3308','3310','3311','3312','3313','3317','3321','3322','3323','3324','3325','3332','3338','3339','3346','3354','3356','3360','3362','3363','3372','3373','3374','3376','3379','3380','3383','3388','3390','3402','3406','3413','3416','3419','3426','3432','3434','3437','3438','3441','3443','3444','3450','3454','3455','3465','3466','3479','3481','3483','3484','3489','3490','3491','3492','3494','3498','3499','3501','3504','3508','3511','3512','3515','3516','3518','3520','3521','3522','3523','3526','3527','3528','3529','3530','3531','3532','3533','3535','3536','3537','3540','3541','3543','3545','3546','3548','3550','3551','3552','3555','3556','3557','3558','3563','3564','3567','3570','3576','3577','3580','3581','3583','3587','3588','3591','3593','3594','3596','3597','3605','3607','3609','3611','3615','3617','3622','3623','3624','3625','3628','3629','3630','3631','3632','3642','3645','3646','3652','3653','3661','3663','3664','3665','3666','3669','3672','3673','3675','3679','3680','3682','3684','3685','3686','3687','3689','3691','3693','3694','3698','3701','3702','3703','3704','3705','3706','3707','3708','3709','3710','3711','3712','3713','4102','4104','4105','4106','4107','4108','4109','4111','4113','4114','4116','4119','4120','4121','4123','4126','4127','4128','4129','4130','4131','4133','4137','4138','4139','4141','4142','4147','4148','4152','4153','4154','4155','4157','4160','4161','4162','4163','4164','4167','4168','4171','4173','4174','4175','4183','4188','4190','4192','4198','4205','4207','4303','4304','4305','4306','4401','4402','4406','4413','4414','4416','4417','4419','4420','4426','4429','4430','4432','4433','4438','4439','4502','4503','4506','4510','4513','4523','4526','4527','4528','4529','4530','4532','4533','4534','4535','4536','4538','4540','4541','4542','4543','4545','4549','4550','4551','4552','4554','4555','4556','4557','4560','4561','4562','4563','4564','4566','4568','4571','4572','4576','4580','4581','4609','4702','4706','4707','4711','4712','4714','4716','4720','4721','4722','4725','4726','4728','4729','4735','4736','4737','4739','4741','4743','4744','4745','4746','4747','4754','4755','4760','4763','4764','4766','4767','4803','4804','4806','4807','4903','4904','4905','4906','4907','4908','4909','4911','4912','4915','4916','4919','4924','4927','4930','4931','4933','4934','4935','4938','4939','4942','4943','4944','4945','4946','4950','4952','4953','4956','4958','4960','4961','4966','4967','4968','4971','4972','4973','4974','4976','4977','4979','4987','4989','4991','4994','4995','4999','5007','5009','5011','5013','5014','5015','5016','5102','5201','5202','5203','5205','5206','5209','5210','5211','5212','5213','5215','5220','5223','5225','5227','5230','5234','5243','5245','5251','5258','5263','5264','5269','5272','5274','5276','5278','5281','5283','5284','5285','5287','5288','5289','5291','5299','5301','5302','5306','5309','5310','5312','5314','5315','5321','5324','5328','5340','5344','5345','5347','5348','5351','5353','5355','5356','5364','5371','5381','5383','5386','5388','5392','5398','5403','5410','5425','5426','5432','5434','5438','5439','5443','5450','5452','5455','5457','5460','5464','5465','5468','5469','5471','5474','5475','5478','5481','5483','5484','5487','5488','5489','5490','5493','5498','5508','5511','5512','5514','5515','5516','5519','5520','5521','5522','5523','5525','5529','5530','5531','5533','5534','5536','5538','5543','5546','5601','5603','5604','5607','5608','5609','5701','5703','5704','5706','5820','5864','5871','5876','5878','5880','5902','5903','5904','5905','5906','5907','6005','6015','6016','6020','6021','6023','6024','6026','6101','6103','6104','6108','6109','6111','6112','6113','6114','6115','6116','6117','6118','6120','6121','6122','6123','6124','6125','6126','6127','6128','6129','6130','6131','6133','6134','6136','6138','6139','6140','6141','6142','6143','6144','6146','6147','6148','6150','6151','6152','6153','6154','6155','6156','6158','6160','6161','6163','6164','6165','6166','6167','6168','6169','6170','6171','6172','6173','6174','6175','6176','6177','6179','6180','6182','6183','6184','6185','6186','6187','6188','6189','6190','6191','6192','6194','6195','6196','6197','6198','6199','6201','6202','6203','6204','6205','6206','6207','6208','6209','6210','6212','6213','6214','6215','6216','6217','6218','6219','6220','6221','6222','6223','6224','6225','6226','6227','6228','6229','6230','6231','6233','6234','6235','6236','6237','6239','6240','6241','6242','6243','6244','6245','6246','6247','6248','6251','6257','6259','6261','6263','6264','6265','6266','6269','6270','6271','6274','6275','6276','6277','6278','6279','6281','6282','6283','6284','6285','6287','6288','6289','6290','6291','6292','6294','6404','6405','6409','6411','6412','6414','6415','6416','6417','6418','6419','6425','6426','6431','6432','6435','6438','6441','6442','6443','6446','6449','6451','6452','6456','6457','6461','6462','6464','6465','6469','6470','6472','6477','6482','6485','6486','6488','6491','6492','6494','6496','6499','6504','6505','6506','6508','6509','6510','6512','6514','6516','6523','6525','6527','6530','6531','6532','6533','6535','6538','6541','6542','6547','6548','6552','6556','6558','6560','6561','6568','6569','6570','6573','6574','6576','6577','6578','6579','6581','6582','6588','6589','6590','6591','6592','6593','6594','6596','6598','6603','6605','6609','6612','6613','6615','6616','6624','6625','6629','6640','6641','6642','6643','6649','6654','6655','6662','6664','6666','6667','6668','6669','6670','6671','6672','6674','6679','6680','6683','6690','6697','6698','6703','6706','6715','6716','6727','6732','6754','6803','7402','7556','8011','8016','8021','8024','8027','8028','8032','8033','8034','8038','8039','8040','8042','8043','8044','8046','8047','8048','8049','8050','8054','8059','8064','8066','8067','8068','8069','8070','8071','8072','8074','8076','8077','8080','8081','8083','8084','8085','8086','8087','8088','8089','8091','8092','8093','8096','8097','8099','8101','8103','8104','8105','8107','8109','8110','8111','8112','8114','8121','8131','8147','8150','8155','8163','8171','8176','8182','8183','8201','8210','8213','8215','8222','8234','8240','8249','8255','8261','8271','8277','8279','8284','8289','8291','8299','8341','8342','8349','8354','8358','8367','8374','8383','8390','8401','8403','8404','8406','8409','8410','8411','8415','8416','8418','8420','8421','8422','8423','8424','8426','8427','8429','8431','8432','8433','8435','8436','8437','8440','8442','8443','8444','8446','8450','8454','8455','8462','8463','8464','8466','8467','8472','8473','8476','8477','8478','8480','8481','8482','8488','8489','8499','8905','8906','8908','8916','8917','8921','8923','8924','8926','8927','8928','8929','8930','8931','8932','8933','8935','8936','8937','8938','8940','8941','8942','8996','9802','9902','9904','9905','9906','9907','9908','9910','9911','9912','9914','9917','9918','9919','9921','9924','9925','9926','9927','9928','9929','9930','9931','9933','9934','9935','9937','9938','9939','9940','9941','9942','9943','9944','9945','9946','9949','9950','9951','9955','9958','9960','9962'];
//g_id_list = ['8358'];
g_id_loop_idx = 0;//999;
g_id_loop_idx_min = 0;
g_id_loop_idx_max = 3;

// load
$("#fname").focus();

// step1. click trigger stock price
function startGet(id){
	if (enable == 0)
	{
		return;
	}
	$("#warning").text("");
	FL=[];
	SP=[];
	PC=[];
	enable = 0;
	$("#fname").val("");
	$("#search").css("cursor","not-allowed");
	$("#search").css("background-color","#D1D8DD");
	$("#search").css("color","white");
	$("#search").text(" Loading... ");
	seriesCounter = 0;
	gIdx = 0;
	gStockId = id;
	Highcharts.getJSON(
		'https://api.allorigins.win/get?url=https://www.fugle.tw/api/v2/data/contents/FCNT000099?symbol_id=' + id,
		success
	);
}

// step2. stock price ajax callback trigger get stock info
function success(data) {
	//console.log(data);
	//data2 = JSON.parse(data.contents);
	//console.log(data2);
	data2 = data;
	try { 
	    (function($) {
		PC = data2.data.content.rawContent.day;
	    })(jQuery);
	} catch(err) {
	    $("#warning").text("代碼錯誤");
	    resume();
	    return;
	}
	if (PC.length == 0)
	{
		resume();
		return;
	}
	//PC = data2.data.content.rawContent.day;
	z=new Array();
	for(var i=0; i < data2.data.content.rawContent.day.length; i++) {
	   dt = new Date(data2.data.content.rawContent.day[i].date);
	   z.push([dt.addDays(1), data2.data.content.rawContent.day[i].open, data2.data.content.rawContent.day[i].high, data2.data.content.rawContent.day[i].low, data2.data.content.rawContent.day[i].close, data2.data.content.rawContent.day[i].change, data2.data.content.rawContent.day[i].change_rate])
	}
	//console.log(z);
	seriesOptions[0] = {
		type: 'candlestick',
		data: z,
	};
	getIDName(gStockId);
}

// step3. stock info ajax callback trigger get F operation
function getIDName(id){
	$.ajax(
	  {
		url:"https://api.allorigins.win/get?url=https://www.fugle.tw/api/v2/data/contents/FCNT000001?symbol_id=" + id,
		success: function(res){
		  //res2 = JSON.parse(res.contents);
		  //console.log(res);
		  
		  res2 = res;
		  //console.log(res2);
		  gName = res2.data.content.rawContent.shortName;
		  gLabel[0] = gName;
		  gSecondName = res2.data.content.rawContent.endlishShortName;
		  getF(id);
		}
	  }
	)
}

// step4. F operation ajax callback trigger get spread
function getF(id){
	$.ajax(
	  {
		url:"https://api.allorigins.win/get?url=https://www.fugle.tw/api/v2/data/contents/FCNT000005?symbol_id=" + id,
		success: function(res){
		  //console.log("F");
		  //console.log(res.data.content.rawContent);
		  //res2 = JSON.parse(res.contents);
		  res2 = res;
		  FL = res2.data.content.rawContent;
		  getSpread(id);
		}
	  }
	)
}

// step5. get spread ajax callback trigger computer result
function getSpread(id){
	$.ajax(
	  {
		url:"https://api.allorigins.win/get?url=https://www.fugle.tw/api/v2/data/contents/FCNT000022?symbol_id=" + id,
		success: function(res){
		  //console.log("S");
		  //console.log(res);
		  //res2 = JSON.parse(res.contents);
		  res2 = res;
		  SP = res2.data.content.rawContent;
		  //console.log(res.data.content.rawContent)
		  comp();
		}
	  }
	)
	
}

// step6. computer result
function comp(){
	ClearTmp();
	day_arr = [-1, -2, -3, -4, -7];
	sum = 0;
	for (var i = SP.length -2; i >= 0 ; i--)
	{
		
		tmp = 0;
		day = new Date(SP[i].date);
		diff = 0;
		for (var j = 0; j < 5; j++)
		{
			day_get = new Date(day);
			diff = 5 - day_get.getDay();
			day_get.addDays(diff);
			day_get.addDays(day_arr[j]);
			var v = getIdx(FL, day_get, 2);
			if (v != -1)
			{
				tmp += v;
			}
		}
		
		day = new Date(SP[i].date);
		price = 0;
		//console.log("---vvv---");
		for (var j = 0; j < 5; j++)
		{

			
			day_get = new Date(day);
			day_get.addDays(diff);
			//console.log(day);
			day_get.addDays(day_arr[j]);
			
			//console.log(day_get);
			var v = getIdx(FL, day_get, 1);
			//console.log(v);
			if (v != -1)
			{
				//console.log(FL[v].date);
				//console.log(tmp);
				//console.log(v);
				if (j==0){
					price = getPrice(PC, day_get);
				}
				
				
				
				if (price != -1)
				{
					var this_week = 0;
					var this_week_all = 0;
					var last_week = 0;
					var last_week_all = 0;
					var z_value = 0;
					
					if (price >= 50)
					{
						this_week = SP[i].data[11].shares + SP[i].data[12].shares + SP[i].data[13].shares + SP[i].data[14].shares;
					}
					else
					{
						this_week = SP[i].data[14].shares;
					}
					this_week_all = SP[i].data[16].shares;
					
					if (price >= 50)
					{
						last_week = SP[i+1].data[11].shares + SP[i+1].data[12].shares + SP[i+1].data[13].shares + SP[i+1].data[14].shares;
					}
					else
					{
						last_week = SP[i+1].data[14].shares;
					}
					last_week_all = SP[i+1].data[16].shares;
					// z = 75 + M2 - 3 * N2
					// N2 = G2 / 50
					z = 75 + SP[i].data[16].shares / 10000000 - 3 * price / 50;
					if (z > 100) z = 100;
					if (z < 0) z = 0;
					z = z / 100;
					
					ils = formatFloat(((this_week/this_week_all - last_week/last_week_all)*this_week_all - tmp * z)/this_week_all * 100, 2);
					//console.log(ils);
					if (j == 0)
					{
						
						sum += ils;
						//console.log(sum);
					}
					
					if ( FL[v].FISell == -1)
					{
						FL[v].FISell = ils;
						FL[v].FIBuy = sum;
					}
					
				}
			}
		}
	}
	//console.log(FL[1030]);
	//console.log("done");
	var name = gArr[gIdx];
	z=new Array();
	ils_volume = new Array();
	for(var i=0; i < FL.length; i++) {
		if (FL[i].FIBuy != -1)
		{
		   dt = new Date(FL[i].date).getTime() + 24*60*60*1000;
		   //console.log(new Date(dt))
		   z.push([dt, formatFloat(FL[i].FIBuy,2)]);
		   //console.log(z)
		   //console.log(formatFloat(FL[i].FISell,2));
		   ils_volume.push([dt, formatFloat(FL[i].FISell,2)]);
		}
	}
	var pos_last, pos_this, sign;
	/* 	
		// Type 1
		sign = 1;
		pos_last = (z[z.length - 6][0]);
		pos_this = (z[z.length - 1][0]);
		if (pos_last > pos_this) sign = -1;
		//console.log(pos_last);
		//console.log(pos_this);
		//console.log(gStockId + "/" + gName + ": " + formatFloat((pos_this - pos_last)/ pos_last , 4) * sign);
	*/

	// Type 2
	/*var str = gStockId + "," + gName + ",";
	for (var j = (z.length - 1); j > 0; j -= 5)
	{
		str += ils_volume[j][1] + ","
	}
	console.log(str);*/

	// Type 3
	var str = "<tr><td>" + gStockId + "</td><td>" + gName + "</td>";
	for (var j = (z.length - 1); j > 0; j -= 5)
	{
		str += "<td>" + ils_volume[j][1] + "%</td>"
	}
	//console.log(str);
	$('#tb').append(str + "</tr>");
	$('#com_box').text("完成度: " + g_id_loop_idx + "/" + g_id_list.length + "(" + Math.round((g_id_loop_idx)*100/g_id_list.length*100)/100 + "%)");

    seriesOptions[1] = {
		yAxis: 1,
		type: 'area',
        name: "內部持股比例",
        data: z,
		color: "#E4BA6B",
    };
	
    seriesOptions[2] = {
		yAxis: 2,
		type: 'column',
        name: "內部持股變化",
        data: ils_volume,
		color: "#5C5C61",
    };

	//createChart();
	//console.log("Pdone");
	
    resume();
}


// module or function

function resume(){
	enable = 1;
	if (g_id_loop_idx == g_id_list.length)
	{
		$("#search").css("cursor","pointer");
		$("#search").css("background-color","#00BC8A");
		$("#search").css("color","#fff");
		$("#search").text(" Search ");
		g_id_loop_idx = 0;
	}
	else
	{
		//var stock__id = pad(g_id_loop_idx,4);
		//console.log(stock__id)
		stock__id = pad(g_id_list[g_id_loop_idx],4);
		g_id_loop_idx++;
		startGet(stock__id);
	}
	
}

function getPrice(Arr, symb){
	
	for (var i = 0; i < Arr.length; i++)
	{
		if( (new Date(Arr[i].date).getTime() == new Date(symb).getTime()))
		{
			return Arr[i].close;
		}
	}
	return -1;
}

function getIdx(Arr, symb, type){
	
	for (var i = 0; i < Arr.length; i++)
	{
		if( (new Date(Arr[i].date).getTime() == new Date(symb).getTime()))
		{
			if (type == 1) {
				return i;
			}
			return Arr[i].total;
		}
	}
	return -1;
}

Date.prototype.addDays = function(days) {
  this.setDate(this.getDate() + days);
  return this;
}

function ClearTmp(){
	for (var i = 0; i < FL.length; i++){
		FL[i].FIBuy = -1;
		FL[i].FISell = -1;
	}
}

function formatFloat(num, pos)
{
  var size = Math.pow(10, pos);
  return Math.round(num * size) / size;
}

function pad(num, n) { 
	var i = (num + "").length; 
	while(i++ < n) num = "0" + num; 
	return num; 
}

// highcharts
function createChart() {

    Highcharts.stockChart('container', {

		title: {
			text: gName + " (" + gStockId + ")"
		},
		
		subtitle: {
			text: gSecondName + " (" + gStockId + ")"
		},

        rangeSelector: {
            selected: 4
        },
		
		 xAxis: {
		  type: 'datetime',
		  maxZoom: 8 * 35 * 24 * 3600000,
		  labels: {
			format: '{value:%Y/%m/%d}',
		  }
		},
		
        yAxis: [{
				labels: {
					align: 'right',
					x: -3
				},
				title: {
					text: '股價'
				},
				height: '60%',
				lineWidth: 2
			},{
				labels: {
					align: 'right',
					x: -3
				},
				title: {
					text: '內部累計持股'
				},
				top: '65%',
				height: '15%',
				offset: 0,
				lineWidth: 2
			},{
				labels: {
					align: 'right',
					x: -3
				},
				title: {
					text: '內部持股變化'
				},
				top: '80%',
				height: '15%',
				offset: 0,
				lineWidth: 2
			}],

        plotOptions: {
            series: {
                //compare: 'value',
                showInNavigator: true
			},
			candlestick: {
				color: '#6c9c46',
				upColor: '#f3746d',
				lineColor: '#6c9c46',
				upLineColor: '#f3746d'
			}
        },

        tooltip: {
            //pointFormat: '<span style="color:{series.color}"><b>{series.name}</b>: <b>{point.y}</b></span><br/>',
            valueDecimals: 2,
            split: true,
			formatter: function() {
			  var points = this.points,
				tooltipArray = ['<b>' + Highcharts.dateFormat('%Y/%m/%d', this.x) + '</b>']

			  points.forEach(function(point, index) {
				  if (index == 0) {
					  tooltipArray.push('<br><b>開盤: </b>' + point.point.open +
					'<br><b>最高: </b>' + point.point.high +
					'<br><b>最低: </b>' + point.point.low +
					'<br><b>收盤: </b>' + point.point.close);
				  }
				 else
				 {
					 tooltipArray.push('<b>' + gLabel[index] + ': </b>' + formatFloat(point.y,2) + '%');
				 }
			  });

			  return tooltipArray;
			}
        },

        series: seriesOptions
    });
}

resume();


// ------------------
// listener
$("#fname").keypress(function(e){
	code = (e.keyCode ? e.keyCode : e.which);
	if (code == 13)
	{
		$( "#search" ).trigger( "click" );
	}
});

$("#fname").click(function(){
	$("#fname").val("");
  });

$("#search").mouseenter(function(){
  if (enable == 1)
  {
    $("#search").css("background-color","#00D69D");
  }
});

$("#search").mouseleave(function(){
  if (enable == 1)
  {
    $("#search").css("background-color","#00BC8A");
  }
});

$("#search").click(function(){
	//startGet($("#fname").val());
	resume();
})